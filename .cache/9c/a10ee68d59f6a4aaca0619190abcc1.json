{"id":"eKit","dependencies":[{"name":"/Users/yangjunran/Desktop/github/sv-demo/node_modules/vega-transform-omnisci-core/build/vega-transform-omnisci-core.umd.js.map","includedInParent":true,"mtime":1620836215045},{"name":"/Users/yangjunran/Desktop/github/sv-demo/package.json","includedInParent":true,"mtime":1620836303330},{"name":"/Users/yangjunran/Desktop/github/sv-demo/node_modules/vega-transform-omnisci-core/package.json","includedInParent":true,"mtime":1620836215045},{"name":"vega","loc":{"line":1,"column":93},"parent":"/Users/yangjunran/Desktop/github/sv-demo/node_modules/vega-transform-omnisci-core/build/vega-transform-omnisci-core.umd.js","resolved":"/Users/yangjunran/Desktop/github/sv-demo/node_modules/vega/build/vega.module.js"}],"generated":{"js":"var define;\nvar e;!function(r,s){\"object\"==typeof exports&&\"undefined\"!=typeof module?module.exports=s(require(\"vega\")):\"function\"==typeof e&&e.amd?e([\"vega\"],s):(r||self).QueryCore=s(r.vega)}(this,function(e){function r(r){e.Transform.call(this,[],r)}return r.session=function(e){return e?(this._session=e,this):this._session},r.Definition={type:\"QueryCore\",metadata:{changes:!0,source:!0},params:[{name:\"query\",type:\"string\",required:!0}]},e.inherits(r,e.Transform).transform=function(s,n){try{var o=this;if(!r._session)throw Error(\"OmniSci Core session missing. Please assign it to the Vega transform by calling `QueryCore.session(session).`\");return n.dataflow.info(\"OmniSci Core Query: \"+s.query),Promise.resolve(r._session.queryAsync(s.query)).then(function(r){r.forEach(e.ingest);var s=n.fork(n.NO_FIELDS&n.NO_SOURCE);return s.rem=o.value,o.value=s.add=s.source=r,s})}catch(e){return Promise.reject(e)}},r});"},"sourceMaps":{"js":{"mappings":[{"source":"../index.js","name":null,"original":{"line":35,"column":0},"generated":{"line":2,"column":0}},{"source":"../index.js","name":null,"original":{"line":35,"column":0},"generated":{"line":2,"column":4}},{"source":"../index.js","name":"QueryCore","original":{"line":9,"column":24},"generated":{"line":2,"column":7}},{"source":"../index.js","name":"QueryCore","original":{"line":9,"column":24},"generated":{"line":2,"column":16}},{"source":"../index.js","name":"QueryCore","original":{"line":9,"column":24},"generated":{"line":2,"column":18}},{"source":"../index.js","name":"QueryCore","original":{"line":9,"column":24},"generated":{"line":2,"column":21}},{"source":"../index.js","name":"QueryCore","original":{"line":9,"column":24},"generated":{"line":2,"column":38}},{"source":"../index.js","name":"QueryCore","original":{"line":9,"column":24},"generated":{"line":2,"column":47}},{"source":"../index.js","name":"QueryCore","original":{"line":9,"column":24},"generated":{"line":2,"column":67}},{"source":"../index.js","name":"QueryCore","original":{"line":9,"column":24},"generated":{"line":2,"column":74}},{"source":"../index.js","name":"QueryCore","original":{"line":9,"column":24},"generated":{"line":2,"column":81}},{"source":"../index.js","name":"QueryCore","original":{"line":9,"column":24},"generated":{"line":2,"column":89}},{"source":"../index.js","name":"QueryCore","original":{"line":9,"column":24},"generated":{"line":2,"column":91}},{"source":"../index.js","name":"QueryCore","original":{"line":9,"column":24},"generated":{"line":2,"column":99}},{"source":"../index.js","name":"QueryCore","original":{"line":9,"column":24},"generated":{"line":2,"column":108}},{"source":"../index.js","name":"QueryCore","original":{"line":9,"column":24},"generated":{"line":2,"column":127}},{"source":"../index.js","name":"QueryCore","original":{"line":9,"column":24},"generated":{"line":2,"column":130}},{"source":"../index.js","name":"QueryCore","original":{"line":9,"column":24},"generated":{"line":2,"column":132}},{"source":"../index.js","name":"QueryCore","original":{"line":9,"column":24},"generated":{"line":2,"column":136}},{"source":"../index.js","name":"QueryCore","original":{"line":9,"column":24},"generated":{"line":2,"column":138}},{"source":"../index.js","name":"QueryCore","original":{"line":9,"column":24},"generated":{"line":2,"column":139}},{"source":"../index.js","name":"QueryCore","original":{"line":9,"column":24},"generated":{"line":2,"column":147}},{"source":"../index.js","name":"QueryCore","original":{"line":9,"column":24},"generated":{"line":2,"column":151}},{"source":"../index.js","name":"QueryCore","original":{"line":9,"column":24},"generated":{"line":2,"column":154}},{"source":"../index.js","name":"QueryCore","original":{"line":9,"column":24},"generated":{"line":2,"column":160}},{"source":"../index.js","name":"QueryCore","original":{"line":9,"column":24},"generated":{"line":2,"column":170}},{"source":"../index.js","name":"QueryCore","original":{"line":9,"column":24},"generated":{"line":2,"column":172}},{"source":"../index.js","name":"QueryCore","original":{"line":9,"column":24},"generated":{"line":2,"column":174}},{"source":"../index.js","name":"QueryCore","original":{"line":9,"column":24},"generated":{"line":2,"column":180}},{"source":"../index.js","name":"QueryCore","original":{"line":9,"column":24},"generated":{"line":2,"column":181}},{"source":"../index.js","name":"QueryCore","original":{"line":9,"column":24},"generated":{"line":2,"column":186}},{"source":"../index.js","name":"QueryCore","original":{"line":9,"column":24},"generated":{"line":2,"column":195}},{"source":"../index.js","name":"QueryCore","original":{"line":9,"column":24},"generated":{"line":2,"column":198}},{"source":"../index.js","name":"QueryCore","original":{"line":9,"column":24},"generated":{"line":2,"column":207}},{"source":"../index.js","name":"QueryCore","original":{"line":9,"column":24},"generated":{"line":2,"column":209}},{"source":"../index.js","name":"QueryCore","original":{"line":9,"column":24},"generated":{"line":2,"column":212}},{"source":"../index.js","name":"QueryCore","original":{"line":9,"column":24},"generated":{"line":2,"column":214}},{"source":"../index.js","name":"QueryCore","original":{"line":9,"column":24},"generated":{"line":2,"column":224}},{"source":"../index.js","name":"QueryCore","original":{"line":9,"column":24},"generated":{"line":2,"column":229}},{"source":"../index.js","name":"QueryCore","original":{"line":9,"column":24},"generated":{"line":2,"column":234}},{"source":"../index.js","name":"QueryCore","original":{"line":9,"column":24},"generated":{"line":2,"column":237}},{"source":"../index.js","name":"QueryCore","original":{"line":9,"column":24},"generated":{"line":2,"column":240}},{"source":"../index.js","name":"QueryCore","original":{"line":9,"column":24},"generated":{"line":2,"column":247}},{"source":"../index.js","name":"QueryCore","original":{"line":9,"column":24},"generated":{"line":2,"column":249}},{"source":"../index.js","name":"call","original":{"line":10,"column":12},"generated":{"line":2,"column":257}},{"source":"../index.js","name":"call","original":{"line":10,"column":12},"generated":{"line":2,"column":266}},{"source":"../index.js","name":"this","original":{"line":10,"column":17},"generated":{"line":2,"column":269}},{"source":"../index.js","name":null,"original":{"line":10,"column":23},"generated":{"line":2,"column":276}},{"source":"../index.js","name":"params","original":{"line":10,"column":27},"generated":{"line":2,"column":279}},{"source":"../index.js","name":"QueryCore","original":{"line":18,"column":0},"generated":{"line":2,"column":284}},{"source":"../index.js","name":"session","original":{"line":18,"column":10},"generated":{"line":2,"column":293}},{"source":"../index.js","name":null,"original":{"line":18,"column":20},"generated":{"line":2,"column":295}},{"source":"../index.js","name":null,"original":{"line":18,"column":20},"generated":{"line":2,"column":301}},{"source":"../index.js","name":"session","original":{"line":18,"column":29},"generated":{"line":2,"column":306}},{"source":"../index.js","name":"session","original":{"line":19,"column":6},"generated":{"line":2,"column":316}},{"source":"../index.js","name":"session","original":{"line":19,"column":6},"generated":{"line":2,"column":318}},{"source":"../index.js","name":"session","original":{"line":20,"column":20},"generated":{"line":2,"column":329}},{"source":"../index.js","name":"session","original":{"line":20,"column":20},"generated":{"line":2,"column":330}},{"source":"../index.js","name":"session","original":{"line":20,"column":20},"generated":{"line":2,"column":335}},{"source":"../index.js","name":"_session","original":{"line":24,"column":14},"generated":{"line":2,"column":347}},{"source":"../index.js","name":"QueryCore","original":{"line":27,"column":0},"generated":{"line":2,"column":356}},{"source":"../index.js","name":"QueryCore","original":{"line":27,"column":0},"generated":{"line":2,"column":357}},{"source":"../index.js","name":null,"original":{"line":27,"column":23},"generated":{"line":2,"column":366}},{"source":"../index.js","name":null,"original":{"line":27,"column":23},"generated":{"line":2,"column":368}},{"source":"../index.js","name":null,"original":{"line":28,"column":8},"generated":{"line":2,"column":376}},{"source":"../index.js","name":null,"original":{"line":28,"column":8},"generated":{"line":2,"column":379}},{"source":"../index.js","name":"metadata","original":{"line":29,"column":2},"generated":{"line":2,"column":386}},{"source":"../index.js","name":"metadata","original":{"line":29,"column":2},"generated":{"line":2,"column":387}},{"source":"../index.js","name":"metadata","original":{"line":29,"column":2},"generated":{"line":2,"column":388}},{"source":"../index.js","name":null,"original":{"line":29,"column":12},"generated":{"line":2,"column":393}},{"source":"../index.js","name":"changes","original":{"line":29,"column":14},"generated":{"line":2,"column":401}},{"source":"../index.js","name":null,"original":{"line":29,"column":23},"generated":{"line":2,"column":406}},{"source":"../index.js","name":null,"original":{"line":29,"column":37},"generated":{"line":2,"column":415}},{"source":"../index.js","name":null,"original":{"line":30,"column":10},"generated":{"line":2,"column":425}},{"source":"../index.js","name":null,"original":{"line":30,"column":10},"generated":{"line":2,"column":430}},{"source":"../index.js","name":"name","original":{"line":30,"column":13},"generated":{"line":2,"column":432}},{"source":"../index.js","name":"type","original":{"line":30,"column":28},"generated":{"line":2,"column":441}},{"source":"../index.js","name":"type","original":{"line":30,"column":28},"generated":{"line":2,"column":443}},{"source":"../index.js","name":"type","original":{"line":30,"column":28},"generated":{"line":2,"column":445}},{"source":"../index.js","name":"required","original":{"line":30,"column":44},"generated":{"line":2,"column":456}},{"source":"../index.js","name":null,"original":{"line":30,"column":54},"generated":{"line":2,"column":466}},{"source":"../index.js","name":"QueryCore","original":{"line":33,"column":27},"generated":{"line":2,"column":475}},{"source":"../index.js","name":"QueryCore","original":{"line":33,"column":27},"generated":{"line":2,"column":477}},{"source":"../index.js","name":"QueryCore","original":{"line":33,"column":27},"generated":{"line":2,"column":480}},{"source":"../index.js","name":"QueryCore","original":{"line":33,"column":27},"generated":{"line":2,"column":484}},{"source":"../index.js","name":"transform","original":{"line":35,"column":10},"generated":{"line":2,"column":488}},{"source":"../index.js","name":"transform","original":{"line":35,"column":10},"generated":{"line":2,"column":490}},{"source":"../index.js","name":"transform","original":{"line":35,"column":10},"generated":{"line":2,"column":495}},{"source":"../index.js","name":"transform","original":{"line":35,"column":10},"generated":{"line":2,"column":499}},{"source":"../index.js","name":"_","original":{"line":35,"column":37},"generated":{"line":2,"column":501}},{"source":"../index.js","name":"_","original":{"line":35,"column":37},"generated":{"line":2,"column":510}},{"source":"../index.js","name":"_","original":{"line":35,"column":37},"generated":{"line":2,"column":516}},{"source":"../index.js","name":"this","original":{"line":49,"column":12},"generated":{"line":2,"column":522}},{"source":"../index.js","name":null,"original":{"line":35,"column":47},"generated":{"line":2,"column":635}},{"source":"../index.js","name":null,"original":{"line":35,"column":47},"generated":{"line":2,"column":642}},{"source":"../index.js","name":null,"original":{"line":35,"column":47},"generated":{"line":2,"column":644}},{"source":"../index.js","name":null,"original":{"line":35,"column":47},"generated":{"line":2,"column":653}},{"source":"../index.js","name":null,"original":{"line":35,"column":47},"generated":{"line":2,"column":658}},{"source":"../index.js","name":"pulse","original":{"line":42,"column":2},"generated":{"line":2,"column":681}},{"source":"../index.js","name":"pulse","original":{"line":42,"column":2},"generated":{"line":2,"column":683}},{"source":"../index.js","name":"info","original":{"line":42,"column":17},"generated":{"line":2,"column":690}},{"source":"../index.js","name":"_","original":{"line":42,"column":45},"generated":{"line":2,"column":698}},{"source":"../index.js","name":"_","original":{"line":42,"column":45},"generated":{"line":2,"column":706}},{"source":"../index.js","name":"_","original":{"line":42,"column":45},"generated":{"line":2,"column":708}},{"source":"../index.js","name":"_","original":{"line":42,"column":45},"generated":{"line":2,"column":717}},{"source":"../index.js","name":"QueryCore","original":{"line":44,"column":23},"generated":{"line":2,"column":728}},{"source":"../index.js","name":"QueryCore","original":{"line":44,"column":23},"generated":{"line":2,"column":730}},{"source":"../index.js","name":"QueryCore","original":{"line":44,"column":23},"generated":{"line":2,"column":738}},{"source":"../index.js","name":"QueryCore","original":{"line":44,"column":23},"generated":{"line":2,"column":743}},{"source":"../index.js","name":"_session","original":{"line":44,"column":33},"generated":{"line":2,"column":752}},{"source":"../index.js","name":"queryAsync","original":{"line":44,"column":42},"generated":{"line":2,"column":755}},{"source":"../index.js","name":"queryAsync","original":{"line":44,"column":42},"generated":{"line":2,"column":757}},{"source":"../index.js","name":"_","original":{"line":44,"column":53},"generated":{"line":2,"column":765}},{"source":"../index.js","name":"_","original":{"line":44,"column":53},"generated":{"line":2,"column":767}},{"source":"../index.js","name":"result","original":{"line":44,"column":8},"generated":{"line":2,"column":775}},{"source":"../index.js","name":"result","original":{"line":44,"column":8},"generated":{"line":2,"column":779}},{"source":"../index.js","name":"result","original":{"line":44,"column":8},"generated":{"line":2,"column":781}},{"source":"../index.js","name":"result","original":{"line":44,"column":8},"generated":{"line":2,"column":783}},{"source":"../index.js","name":"result","original":{"line":44,"column":8},"generated":{"line":2,"column":788}},{"source":"../index.js","name":"result","original":{"line":44,"column":8},"generated":{"line":2,"column":790}},{"source":"../index.js","name":"forEach","original":{"line":46,"column":9},"generated":{"line":2,"column":800}},{"source":"../index.js","name":"ingest","original":{"line":46,"column":17},"generated":{"line":2,"column":802}},{"source":"../index.js","name":null,"original":{"line":48,"column":2},"generated":{"line":2,"column":813}},{"source":"../index.js","name":"out","original":{"line":48,"column":8},"generated":{"line":2,"column":820}},{"source":"../index.js","name":"out","original":{"line":48,"column":8},"generated":{"line":2,"column":822}},{"source":"../index.js","name":"fork","original":{"line":48,"column":20},"generated":{"line":2,"column":826}},{"source":"../index.js","name":"pulse","original":{"line":48,"column":25},"generated":{"line":2,"column":828}},{"source":"../index.js","name":"NO_FIELDS","original":{"line":48,"column":31},"generated":{"line":2,"column":834}},{"source":"../index.js","name":"pulse","original":{"line":48,"column":43},"generated":{"line":2,"column":836}},{"source":"../index.js","name":"pulse","original":{"line":48,"column":43},"generated":{"line":2,"column":842}},{"source":"../index.js","name":"pulse","original":{"line":48,"column":43},"generated":{"line":2,"column":844}},{"source":"../index.js","name":null,"original":{"line":52,"column":2},"generated":{"line":2,"column":848}},{"source":"../index.js","name":null,"original":{"line":52,"column":2},"generated":{"line":2,"column":850}},{"source":"../index.js","name":null,"original":{"line":52,"column":2},"generated":{"line":2,"column":857}},{"source":"../index.js","name":"out","original":{"line":49,"column":2},"generated":{"line":2,"column":859}},{"source":"../index.js","name":"out","original":{"line":49,"column":2},"generated":{"line":2,"column":863}},{"source":"../index.js","name":"_this2","original":{"line":49,"column":12},"generated":{"line":2,"column":869}},{"source":"../index.js","name":"value","original":{"line":49,"column":17},"generated":{"line":2,"column":872}},{"source":"../index.js","name":"value","original":{"line":50,"column":7},"generated":{"line":2,"column":879}},{"source":"../index.js","name":"add","original":{"line":50,"column":19},"generated":{"line":2,"column":887}},{"source":"../index.js","name":"source","original":{"line":50,"column":29},"generated":{"line":2,"column":894}},{"source":"../index.js","name":"result","original":{"line":50,"column":38},"generated":{"line":2,"column":899}}],"sources":{"../index.js":"import { inherits, ingest, Transform } from \"vega\";\n\n/**\n * Generates a function to query data from an OmniSci Core database.\n * @constructor\n * @param {object} params - The parameters for this operator.\n * @param {function(object): *} params.query - The SQL query.\n */\nexport default function QueryCore(params) {\n  Transform.call(this, [], params);\n}\n\n/**\n * Set the OmniSci Core session.\n * \n * @param {*} session \n */\nQueryCore.session = function(session) {\n  if (session) {\n    this._session = session;\n    return this;\n  }\n\n  return this._session;\n};\n\nQueryCore.Definition = {\n  type: \"QueryCore\",\n  metadata: { changes: true, source: true },\n  params: [{ name: \"query\", type: \"string\", required: true }]\n};\n\nconst prototype = inherits(QueryCore, Transform);\n\nprototype.transform = async function(_, pulse) {\n  if (!QueryCore._session) {\n    throw Error(\n      \"OmniSci Core session missing. Please assign it to the Vega transform by calling `QueryCore.session(session).`\"\n    );\n  }\n\n  pulse.dataflow.info(`OmniSci Core Query: ${_.query}`);\n\n  const result = await QueryCore._session.queryAsync(_.query);\n\n  result.forEach(ingest);\n\n  const out = pulse.fork(pulse.NO_FIELDS & pulse.NO_SOURCE);\n  out.rem = this.value;\n  this.value = out.add = out.source = result;\n\n  return out;\n};\n"},"lineCount":null}},"error":null,"hash":"4af4d67661a5c1d28ed7f906d6726f25","cacheData":{"env":{}}}