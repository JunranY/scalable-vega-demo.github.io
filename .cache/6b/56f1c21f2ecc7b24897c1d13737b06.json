{"id":"X9kx","dependencies":[{"name":"/Users/yangjunran/Desktop/github/sv-demo/node_modules/apache-arrow/io/whatwg/reader.js.map","includedInParent":true,"mtime":1620712940685},{"name":"/Users/yangjunran/Desktop/github/sv-demo/package.json","includedInParent":true,"mtime":1620836303330},{"name":"/Users/yangjunran/Desktop/github/sv-demo/node_modules/apache-arrow/package.json","includedInParent":true,"mtime":1620712940685},{"name":"../../io/stream","loc":{"line":20,"column":25},"parent":"/Users/yangjunran/Desktop/github/sv-demo/node_modules/apache-arrow/io/whatwg/reader.js","resolved":"/Users/yangjunran/Desktop/github/sv-demo/node_modules/apache-arrow/io/stream.js"},{"name":"../../ipc/reader","loc":{"line":21,"column":25},"parent":"/Users/yangjunran/Desktop/github/sv-demo/node_modules/apache-arrow/io/whatwg/reader.js","resolved":"/Users/yangjunran/Desktop/github/sv-demo/node_modules/apache-arrow/ipc/reader.js"}],"generated":{"js":"\"use strict\";Object.defineProperty(exports,\"__esModule\",{value:!0}),exports.recordBatchReaderThroughDOMStream=void 0;const e=require(\"../../io/stream\"),a=require(\"../../ipc/reader\");function r(r,t){const n=new e.AsyncByteQueue;let c=null;const o=new ReadableStream({async cancel(){await n.close()},async start(e){await i(e,c||(c=await async function(){return await(await a.RecordBatchReader.from(n)).open(t)}()))},async pull(e){c?await i(e,c):e.close()}});return{writable:new WritableStream(n,{highWaterMark:16384,...r}),readable:o};async function i(e,a){let r=e.desiredSize,t=null;for(;!(t=await a.next()).done;)if(e.enqueue(t.value),null!=r&&--r<=0)return;e.close()}}exports.recordBatchReaderThroughDOMStream=r;"},"sourceMaps":{"js":{"mappings":[{"source":"io/whatwg/reader.ts","name":null,"original":{"line":20,"column":0},"generated":{"line":1,"column":117}},{"source":"io/whatwg/reader.ts","name":null,"original":{"line":20,"column":0},"generated":{"line":1,"column":123}},{"source":"io/whatwg/reader.ts","name":null,"original":{"line":20,"column":0},"generated":{"line":1,"column":125}},{"source":"io/whatwg/reader.ts","name":null,"original":{"line":20,"column":0},"generated":{"line":1,"column":133}},{"source":"io/whatwg/reader.ts","name":null,"original":{"line":21,"column":0},"generated":{"line":1,"column":152}},{"source":"io/whatwg/reader.ts","name":null,"original":{"line":21,"column":0},"generated":{"line":1,"column":154}},{"source":"io/whatwg/reader.ts","name":null,"original":{"line":21,"column":0},"generated":{"line":1,"column":162}},{"source":"io/whatwg/reader.ts","name":null,"original":{"line":24,"column":0},"generated":{"line":1,"column":182}},{"source":"io/whatwg/reader.ts","name":null,"original":{"line":24,"column":16},"generated":{"line":1,"column":191}},{"source":"io/whatwg/reader.ts","name":null,"original":{"line":24,"column":95},"generated":{"line":1,"column":193}},{"source":"io/whatwg/reader.ts","name":null,"original":{"line":24,"column":141},"generated":{"line":1,"column":195}},{"source":"io/whatwg/reader.ts","name":null,"original":{"line":26,"column":4},"generated":{"line":1,"column":198}},{"source":"io/whatwg/reader.ts","name":null,"original":{"line":26,"column":10},"generated":{"line":1,"column":204}},{"source":"io/whatwg/reader.ts","name":null,"original":{"line":26,"column":18},"generated":{"line":1,"column":206}},{"source":"io/whatwg/reader.ts","name":null,"original":{"line":26,"column":22},"generated":{"line":1,"column":210}},{"source":"io/whatwg/reader.ts","name":null,"original":{"line":26,"column":22},"generated":{"line":1,"column":212}},{"source":"io/whatwg/reader.ts","name":null,"original":{"line":27,"column":4},"generated":{"line":1,"column":227}},{"source":"io/whatwg/reader.ts","name":null,"original":{"line":27,"column":8},"generated":{"line":1,"column":231}},{"source":"io/whatwg/reader.ts","name":null,"original":{"line":27,"column":46},"generated":{"line":1,"column":233}},{"source":"io/whatwg/reader.ts","name":null,"original":{"line":29,"column":4},"generated":{"line":1,"column":238}},{"source":"io/whatwg/reader.ts","name":null,"original":{"line":29,"column":10},"generated":{"line":1,"column":244}},{"source":"io/whatwg/reader.ts","name":null,"original":{"line":29,"column":21},"generated":{"line":1,"column":246}},{"source":"io/whatwg/reader.ts","name":null,"original":{"line":29,"column":25},"generated":{"line":1,"column":250}},{"source":"io/whatwg/reader.ts","name":null,"original":{"line":29,"column":56},"generated":{"line":1,"column":265}},{"source":"io/whatwg/reader.ts","name":null,"original":{"line":30,"column":8},"generated":{"line":1,"column":266}},{"source":"io/whatwg/reader.ts","name":null,"original":{"line":30,"column":31},"generated":{"line":1,"column":287}},{"source":"io/whatwg/reader.ts","name":null,"original":{"line":30,"column":37},"generated":{"line":1,"column":289}},{"source":"io/whatwg/reader.ts","name":null,"original":{"line":31,"column":8},"generated":{"line":1,"column":298}},{"source":"io/whatwg/reader.ts","name":null,"original":{"line":31,"column":20},"generated":{"line":1,"column":310}},{"source":"io/whatwg/reader.ts","name":null,"original":{"line":31,"column":40},"generated":{"line":1,"column":319}},{"source":"io/whatwg/reader.ts","name":null,"original":{"line":31,"column":45},"generated":{"line":1,"column":321}},{"source":"io/whatwg/reader.ts","name":null,"original":{"line":31,"column":57},"generated":{"line":1,"column":323}},{"source":"io/whatwg/reader.ts","name":null,"original":{"line":31,"column":68},"generated":{"line":1,"column":327}},{"source":"io/whatwg/reader.ts","name":null,"original":{"line":37,"column":4},"generated":{"line":1,"column":335}},{"source":"io/whatwg/reader.ts","name":null,"original":{"line":38,"column":8},"generated":{"line":1,"column":352}},{"source":"io/whatwg/reader.ts","name":null,"original":{"line":38,"column":28},"generated":{"line":1,"column":371}},{"source":"io/whatwg/reader.ts","name":null,"original":{"line":38,"column":28},"generated":{"line":1,"column":373}},{"source":"io/whatwg/reader.ts","name":null,"original":{"line":38,"column":46},"generated":{"line":1,"column":391}},{"source":"io/whatwg/reader.ts","name":null,"original":{"line":38,"column":54},"generated":{"line":1,"column":396}},{"source":"io/whatwg/reader.ts","name":null,"original":{"line":38,"column":62},"generated":{"line":1,"column":400}},{"source":"io/whatwg/reader.ts","name":null,"original":{"line":38,"column":67},"generated":{"line":1,"column":405}},{"source":"io/whatwg/reader.ts","name":null,"original":{"line":31,"column":83},"generated":{"line":1,"column":408}},{"source":"io/whatwg/reader.ts","name":null,"original":{"line":32,"column":8},"generated":{"line":1,"column":414}},{"source":"io/whatwg/reader.ts","name":null,"original":{"line":32,"column":19},"generated":{"line":1,"column":425}},{"source":"io/whatwg/reader.ts","name":null,"original":{"line":32,"column":33},"generated":{"line":1,"column":428}},{"source":"io/whatwg/reader.ts","name":null,"original":{"line":32,"column":48},"generated":{"line":1,"column":436}},{"source":"io/whatwg/reader.ts","name":null,"original":{"line":32,"column":53},"generated":{"line":1,"column":438}},{"source":"io/whatwg/reader.ts","name":null,"original":{"line":32,"column":65},"generated":{"line":1,"column":440}},{"source":"io/whatwg/reader.ts","name":null,"original":{"line":32,"column":75},"generated":{"line":1,"column":443}},{"source":"io/whatwg/reader.ts","name":null,"original":{"line":32,"column":86},"generated":{"line":1,"column":445}},{"source":"io/whatwg/reader.ts","name":null,"original":{"line":35,"column":4},"generated":{"line":1,"column":456}},{"source":"io/whatwg/reader.ts","name":null,"original":{"line":35,"column":11},"generated":{"line":1,"column":462}},{"source":"io/whatwg/reader.ts","name":null,"original":{"line":35,"column":13},"generated":{"line":1,"column":463}},{"source":"io/whatwg/reader.ts","name":null,"original":{"line":35,"column":23},"generated":{"line":1,"column":472}},{"source":"io/whatwg/reader.ts","name":null,"original":{"line":35,"column":27},"generated":{"line":1,"column":476}},{"source":"io/whatwg/reader.ts","name":null,"original":{"line":35,"column":42},"generated":{"line":1,"column":491}},{"source":"io/whatwg/reader.ts","name":null,"original":{"line":35,"column":49},"generated":{"line":1,"column":493}},{"source":"io/whatwg/reader.ts","name":null,"original":{"line":35,"column":51},"generated":{"line":1,"column":494}},{"source":"io/whatwg/reader.ts","name":null,"original":{"line":35,"column":68},"generated":{"line":1,"column":508}},{"source":"io/whatwg/reader.ts","name":null,"original":{"line":35,"column":80},"generated":{"line":1,"column":517}},{"source":"io/whatwg/reader.ts","name":null,"original":{"line":35,"column":101},"generated":{"line":1,"column":521}},{"source":"io/whatwg/reader.ts","name":null,"original":{"line":35,"column":101},"generated":{"line":1,"column":530}},{"source":"io/whatwg/reader.ts","name":null,"original":{"line":41,"column":4},"generated":{"line":1,"column":533}},{"source":"io/whatwg/reader.ts","name":null,"original":{"line":41,"column":19},"generated":{"line":1,"column":548}},{"source":"io/whatwg/reader.ts","name":null,"original":{"line":41,"column":24},"generated":{"line":1,"column":550}},{"source":"io/whatwg/reader.ts","name":null,"original":{"line":41,"column":85},"generated":{"line":1,"column":552}},{"source":"io/whatwg/reader.ts","name":null,"original":{"line":42,"column":8},"generated":{"line":1,"column":555}},{"source":"io/whatwg/reader.ts","name":null,"original":{"line":42,"column":12},"generated":{"line":1,"column":559}},{"source":"io/whatwg/reader.ts","name":null,"original":{"line":42,"column":19},"generated":{"line":1,"column":561}},{"source":"io/whatwg/reader.ts","name":null,"original":{"line":42,"column":30},"generated":{"line":1,"column":563}},{"source":"io/whatwg/reader.ts","name":null,"original":{"line":43,"column":12},"generated":{"line":1,"column":575}},{"source":"io/whatwg/reader.ts","name":null,"original":{"line":43,"column":55},"generated":{"line":1,"column":577}},{"source":"io/whatwg/reader.ts","name":null,"original":{"line":44,"column":8},"generated":{"line":1,"column":582}},{"source":"io/whatwg/reader.ts","name":null,"original":{"line":44,"column":17},"generated":{"line":1,"column":589}},{"source":"io/whatwg/reader.ts","name":null,"original":{"line":44,"column":27},"generated":{"line":1,"column":597}},{"source":"io/whatwg/reader.ts","name":null,"original":{"line":44,"column":34},"generated":{"line":1,"column":599}},{"source":"io/whatwg/reader.ts","name":null,"original":{"line":44,"column":42},"generated":{"line":1,"column":607}},{"source":"io/whatwg/reader.ts","name":null,"original":{"line":46,"column":12},"generated":{"line":1,"column":613}},{"source":"io/whatwg/reader.ts","name":null,"original":{"line":45,"column":12},"generated":{"line":1,"column":616}},{"source":"io/whatwg/reader.ts","name":null,"original":{"line":45,"column":23},"generated":{"line":1,"column":618}},{"source":"io/whatwg/reader.ts","name":null,"original":{"line":45,"column":31},"generated":{"line":1,"column":626}},{"source":"io/whatwg/reader.ts","name":null,"original":{"line":45,"column":33},"generated":{"line":1,"column":628}},{"source":"io/whatwg/reader.ts","name":null,"original":{"line":46,"column":24},"generated":{"line":1,"column":635}},{"source":"io/whatwg/reader.ts","name":null,"original":{"line":46,"column":16},"generated":{"line":1,"column":641}},{"source":"io/whatwg/reader.ts","name":null,"original":{"line":46,"column":34},"generated":{"line":1,"column":646}},{"source":"io/whatwg/reader.ts","name":null,"original":{"line":46,"column":42},"generated":{"line":1,"column":649}},{"source":"io/whatwg/reader.ts","name":null,"original":{"line":47,"column":16},"generated":{"line":1,"column":651}},{"source":"io/whatwg/reader.ts","name":null,"original":{"line":50,"column":8},"generated":{"line":1,"column":658}},{"source":"io/whatwg/reader.ts","name":null,"original":{"line":50,"column":19},"generated":{"line":1,"column":660}},{"source":"io/whatwg/reader.ts","name":null,"original":{"line":24,"column":0},"generated":{"line":1,"column":669}},{"source":"io/whatwg/reader.ts","name":null,"original":{"line":24,"column":0},"generated":{"line":1,"column":677}},{"source":"io/whatwg/reader.ts","name":null,"original":{"line":24,"column":0},"generated":{"line":1,"column":711}}],"sources":{"io/whatwg/reader.ts":"// Licensed to the Apache Software Foundation (ASF) under one\n// or more contributor license agreements.  See the NOTICE file\n// distributed with this work for additional information\n// regarding copyright ownership.  The ASF licenses this file\n// to you under the Apache License, Version 2.0 (the\n// \"License\"); you may not use this file except in compliance\n// with the License.  You may obtain a copy of the License at\n//\n//   http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing,\n// software distributed under the License is distributed on an\n// \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n// KIND, either express or implied.  See the License for the\n// specific language governing permissions and limitations\n// under the License.\n\nimport { DataType } from '../../type';\nimport { RecordBatch } from '../../recordbatch';\nimport { AsyncByteQueue } from '../../io/stream';\nimport { RecordBatchReader } from '../../ipc/reader';\n\n/** @ignore */\nexport function recordBatchReaderThroughDOMStream<T extends { [key: string]: DataType } = any>(writableStrategy?: ByteLengthQueuingStrategy, readableStrategy?: { autoDestroy: boolean }) {\n\n    const queue = new AsyncByteQueue();\n    let reader: RecordBatchReader<T> | null = null;\n\n    const readable = new ReadableStream<RecordBatch<T>>({\n        async cancel() { await queue.close(); },\n        async start(controller) { await next(controller, reader || (reader = await open())); },\n        async pull(controller) { reader ? await next(controller, reader) : controller.close(); }\n    });\n\n    return { writable: new WritableStream(queue, { 'highWaterMark': 2 ** 14, ...writableStrategy }), readable };\n\n    async function open() {\n        return await (await RecordBatchReader.from<T>(queue)).open(readableStrategy);\n    }\n\n    async function next(controller: ReadableStreamDefaultController<RecordBatch<T>>, reader: RecordBatchReader<T>) {\n        let size = controller.desiredSize;\n        let r: IteratorResult<RecordBatch<T>> | null = null;\n        while (!(r = await reader.next()).done) {\n            controller.enqueue(r.value);\n            if (size != null && --size <= 0) {\n                return;\n            }\n        }\n        controller.close();\n    }\n}\n"},"lineCount":null}},"error":null,"hash":"c66292e04773cf3491d048945856fc33","cacheData":{"env":{}}}