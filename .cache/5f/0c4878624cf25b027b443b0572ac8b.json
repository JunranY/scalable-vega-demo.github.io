{"id":"WQws","dependencies":[{"name":"/Users/yangjunran/Desktop/github/sv-demo/node_modules/apache-arrow/io/whatwg/writer.js.map","includedInParent":true,"mtime":1620712940685},{"name":"/Users/yangjunran/Desktop/github/sv-demo/package.json","includedInParent":true,"mtime":1620836303330},{"name":"/Users/yangjunran/Desktop/github/sv-demo/node_modules/apache-arrow/package.json","includedInParent":true,"mtime":1620712940685},{"name":"../../io/stream","loc":{"line":20,"column":25},"parent":"/Users/yangjunran/Desktop/github/sv-demo/node_modules/apache-arrow/io/whatwg/writer.js","resolved":"/Users/yangjunran/Desktop/github/sv-demo/node_modules/apache-arrow/io/stream.js"}],"generated":{"js":"\"use strict\";Object.defineProperty(exports,\"__esModule\",{value:!0}),exports.recordBatchWriterThroughDOMStream=void 0;const e=require(\"../../io/stream\");function t(t,r){const a=new this(t),n=new e.AsyncByteStream(a),c=new ReadableStream({type:\"bytes\",async cancel(){await n.cancel()},async pull(e){await i(e)},async start(e){await i(e)}},{highWaterMark:16384,...r});return{writable:new WritableStream(a,t),readable:c};async function i(e){let t=null,r=e.desiredSize;for(;t=await n.read(r||null);)if(e.enqueue(t),null!=r&&(r-=t.byteLength)<=0)return;e.close()}}exports.recordBatchWriterThroughDOMStream=t;"},"sourceMaps":{"js":{"mappings":[{"source":"io/whatwg/writer.ts","name":null,"original":{"line":20,"column":0},"generated":{"line":1,"column":117}},{"source":"io/whatwg/writer.ts","name":null,"original":{"line":20,"column":0},"generated":{"line":1,"column":123}},{"source":"io/whatwg/writer.ts","name":null,"original":{"line":20,"column":0},"generated":{"line":1,"column":125}},{"source":"io/whatwg/writer.ts","name":null,"original":{"line":20,"column":0},"generated":{"line":1,"column":133}},{"source":"io/whatwg/writer.ts","name":null,"original":{"line":24,"column":0},"generated":{"line":1,"column":152}},{"source":"io/whatwg/writer.ts","name":null,"original":{"line":24,"column":16},"generated":{"line":1,"column":161}},{"source":"io/whatwg/writer.ts","name":null,"original":{"line":26,"column":4},"generated":{"line":1,"column":163}},{"source":"io/whatwg/writer.ts","name":null,"original":{"line":27,"column":4},"generated":{"line":1,"column":165}},{"source":"io/whatwg/writer.ts","name":null,"original":{"line":30,"column":4},"generated":{"line":1,"column":168}},{"source":"io/whatwg/writer.ts","name":null,"original":{"line":30,"column":10},"generated":{"line":1,"column":174}},{"source":"io/whatwg/writer.ts","name":null,"original":{"line":30,"column":19},"generated":{"line":1,"column":176}},{"source":"io/whatwg/writer.ts","name":null,"original":{"line":30,"column":23},"generated":{"line":1,"column":180}},{"source":"io/whatwg/writer.ts","name":null,"original":{"line":30,"column":31},"generated":{"line":1,"column":185}},{"source":"io/whatwg/writer.ts","name":null,"original":{"line":31,"column":10},"generated":{"line":1,"column":188}},{"source":"io/whatwg/writer.ts","name":null,"original":{"line":31,"column":19},"generated":{"line":1,"column":190}},{"source":"io/whatwg/writer.ts","name":null,"original":{"line":31,"column":23},"generated":{"line":1,"column":194}},{"source":"io/whatwg/writer.ts","name":null,"original":{"line":31,"column":23},"generated":{"line":1,"column":196}},{"source":"io/whatwg/writer.ts","name":null,"original":{"line":31,"column":39},"generated":{"line":1,"column":212}},{"source":"io/whatwg/writer.ts","name":null,"original":{"line":32,"column":10},"generated":{"line":1,"column":215}},{"source":"io/whatwg/writer.ts","name":null,"original":{"line":32,"column":21},"generated":{"line":1,"column":217}},{"source":"io/whatwg/writer.ts","name":null,"original":{"line":32,"column":25},"generated":{"line":1,"column":221}},{"source":"io/whatwg/writer.ts","name":null,"original":{"line":32,"column":40},"generated":{"line":1,"column":236}},{"source":"io/whatwg/writer.ts","name":null,"original":{"line":33,"column":8},"generated":{"line":1,"column":237}},{"source":"io/whatwg/writer.ts","name":null,"original":{"line":33,"column":14},"generated":{"line":1,"column":242}},{"source":"io/whatwg/writer.ts","name":null,"original":{"line":34,"column":8},"generated":{"line":1,"column":250}},{"source":"io/whatwg/writer.ts","name":null,"original":{"line":34,"column":31},"generated":{"line":1,"column":271}},{"source":"io/whatwg/writer.ts","name":null,"original":{"line":34,"column":38},"generated":{"line":1,"column":273}},{"source":"io/whatwg/writer.ts","name":null,"original":{"line":35,"column":8},"generated":{"line":1,"column":283}},{"source":"io/whatwg/writer.ts","name":null,"original":{"line":35,"column":19},"generated":{"line":1,"column":294}},{"source":"io/whatwg/writer.ts","name":null,"original":{"line":35,"column":39},"generated":{"line":1,"column":303}},{"source":"io/whatwg/writer.ts","name":null,"original":{"line":35,"column":44},"generated":{"line":1,"column":305}},{"source":"io/whatwg/writer.ts","name":null,"original":{"line":36,"column":8},"generated":{"line":1,"column":309}},{"source":"io/whatwg/writer.ts","name":null,"original":{"line":36,"column":20},"generated":{"line":1,"column":321}},{"source":"io/whatwg/writer.ts","name":null,"original":{"line":36,"column":40},"generated":{"line":1,"column":330}},{"source":"io/whatwg/writer.ts","name":null,"original":{"line":36,"column":45},"generated":{"line":1,"column":332}},{"source":"io/whatwg/writer.ts","name":null,"original":{"line":37,"column":7},"generated":{"line":1,"column":337}},{"source":"io/whatwg/writer.ts","name":null,"original":{"line":37,"column":9},"generated":{"line":1,"column":338}},{"source":"io/whatwg/writer.ts","name":null,"original":{"line":37,"column":26},"generated":{"line":1,"column":352}},{"source":"io/whatwg/writer.ts","name":null,"original":{"line":37,"column":38},"generated":{"line":1,"column":361}},{"source":"io/whatwg/writer.ts","name":null,"original":{"line":39,"column":4},"generated":{"line":1,"column":365}},{"source":"io/whatwg/writer.ts","name":null,"original":{"line":39,"column":11},"generated":{"line":1,"column":371}},{"source":"io/whatwg/writer.ts","name":null,"original":{"line":39,"column":13},"generated":{"line":1,"column":372}},{"source":"io/whatwg/writer.ts","name":null,"original":{"line":39,"column":23},"generated":{"line":1,"column":381}},{"source":"io/whatwg/writer.ts","name":null,"original":{"line":39,"column":27},"generated":{"line":1,"column":385}},{"source":"io/whatwg/writer.ts","name":null,"original":{"line":39,"column":42},"generated":{"line":1,"column":400}},{"source":"io/whatwg/writer.ts","name":null,"original":{"line":39,"column":50},"generated":{"line":1,"column":402}},{"source":"io/whatwg/writer.ts","name":null,"original":{"line":39,"column":69},"generated":{"line":1,"column":405}},{"source":"io/whatwg/writer.ts","name":null,"original":{"line":39,"column":69},"generated":{"line":1,"column":414}},{"source":"io/whatwg/writer.ts","name":null,"original":{"line":41,"column":4},"generated":{"line":1,"column":417}},{"source":"io/whatwg/writer.ts","name":null,"original":{"line":41,"column":19},"generated":{"line":1,"column":432}},{"source":"io/whatwg/writer.ts","name":null,"original":{"line":41,"column":24},"generated":{"line":1,"column":434}},{"source":"io/whatwg/writer.ts","name":null,"original":{"line":42,"column":8},"generated":{"line":1,"column":437}},{"source":"io/whatwg/writer.ts","name":null,"original":{"line":42,"column":12},"generated":{"line":1,"column":441}},{"source":"io/whatwg/writer.ts","name":null,"original":{"line":42,"column":37},"generated":{"line":1,"column":443}},{"source":"io/whatwg/writer.ts","name":null,"original":{"line":43,"column":12},"generated":{"line":1,"column":448}},{"source":"io/whatwg/writer.ts","name":null,"original":{"line":43,"column":19},"generated":{"line":1,"column":450}},{"source":"io/whatwg/writer.ts","name":null,"original":{"line":43,"column":30},"generated":{"line":1,"column":452}},{"source":"io/whatwg/writer.ts","name":null,"original":{"line":44,"column":8},"generated":{"line":1,"column":464}},{"source":"io/whatwg/writer.ts","name":null,"original":{"line":44,"column":15},"generated":{"line":1,"column":469}},{"source":"io/whatwg/writer.ts","name":null,"original":{"line":44,"column":27},"generated":{"line":1,"column":477}},{"source":"io/whatwg/writer.ts","name":null,"original":{"line":44,"column":34},"generated":{"line":1,"column":479}},{"source":"io/whatwg/writer.ts","name":null,"original":{"line":44,"column":39},"generated":{"line":1,"column":484}},{"source":"io/whatwg/writer.ts","name":null,"original":{"line":44,"column":47},"generated":{"line":1,"column":487}},{"source":"io/whatwg/writer.ts","name":null,"original":{"line":46,"column":12},"generated":{"line":1,"column":494}},{"source":"io/whatwg/writer.ts","name":null,"original":{"line":45,"column":12},"generated":{"line":1,"column":497}},{"source":"io/whatwg/writer.ts","name":null,"original":{"line":45,"column":23},"generated":{"line":1,"column":499}},{"source":"io/whatwg/writer.ts","name":null,"original":{"line":45,"column":31},"generated":{"line":1,"column":507}},{"source":"io/whatwg/writer.ts","name":null,"original":{"line":46,"column":24},"generated":{"line":1,"column":510}},{"source":"io/whatwg/writer.ts","name":null,"original":{"line":46,"column":16},"generated":{"line":1,"column":516}},{"source":"io/whatwg/writer.ts","name":null,"original":{"line":46,"column":33},"generated":{"line":1,"column":520}},{"source":"io/whatwg/writer.ts","name":null,"original":{"line":46,"column":41},"generated":{"line":1,"column":523}},{"source":"io/whatwg/writer.ts","name":null,"original":{"line":46,"column":45},"generated":{"line":1,"column":525}},{"source":"io/whatwg/writer.ts","name":null,"original":{"line":46,"column":60},"generated":{"line":1,"column":538}},{"source":"io/whatwg/writer.ts","name":null,"original":{"line":46,"column":65},"generated":{"line":1,"column":540}},{"source":"io/whatwg/writer.ts","name":null,"original":{"line":48,"column":8},"generated":{"line":1,"column":547}},{"source":"io/whatwg/writer.ts","name":null,"original":{"line":48,"column":19},"generated":{"line":1,"column":549}},{"source":"io/whatwg/writer.ts","name":null,"original":{"line":24,"column":0},"generated":{"line":1,"column":558}},{"source":"io/whatwg/writer.ts","name":null,"original":{"line":24,"column":0},"generated":{"line":1,"column":566}},{"source":"io/whatwg/writer.ts","name":null,"original":{"line":24,"column":0},"generated":{"line":1,"column":600}}],"sources":{"io/whatwg/writer.ts":"// Licensed to the Apache Software Foundation (ASF) under one\n// or more contributor license agreements.  See the NOTICE file\n// distributed with this work for additional information\n// regarding copyright ownership.  The ASF licenses this file\n// to you under the Apache License, Version 2.0 (the\n// \"License\"); you may not use this file except in compliance\n// with the License.  You may obtain a copy of the License at\n//\n//   http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing,\n// software distributed under the License is distributed on an\n// \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n// KIND, either express or implied.  See the License for the\n// specific language governing permissions and limitations\n// under the License.\n\nimport { DataType } from '../../type';\nimport { RecordBatch } from '../../recordbatch';\nimport { AsyncByteStream } from '../../io/stream';\nimport { RecordBatchWriter } from '../../ipc/writer';\n\n/** @ignore */\nexport function recordBatchWriterThroughDOMStream<T extends { [key: string]: DataType } = any>(\n    this: typeof RecordBatchWriter,\n    writableStrategy?: QueuingStrategy<RecordBatch<T>> & { autoDestroy: boolean },\n    readableStrategy?: { highWaterMark?: number; size?: any }\n) {\n\n    const writer = new this<T>(writableStrategy);\n    const reader = new AsyncByteStream(writer);\n    const readable = new ReadableStream({\n        type: 'bytes',\n        async cancel() { await reader.cancel(); },\n        async pull(controller) { await next(controller); },\n        async start(controller) { await next(controller); },\n    }, { 'highWaterMark': 2 ** 14, ...readableStrategy });\n\n    return { writable: new WritableStream(writer, writableStrategy), readable };\n\n    async function next(controller: ReadableStreamDefaultController<Uint8Array>) {\n        let buf: Uint8Array | null = null;\n        let size = controller.desiredSize;\n        while (buf = await reader.read(size || null)) {\n            controller.enqueue(buf);\n            if (size != null && (size -= buf.byteLength) <= 0) { return; }\n        }\n        controller.close();\n    }\n}\n"},"lineCount":null}},"error":null,"hash":"61689a80a76ce2a34beac31603a2e128","cacheData":{"env":{}}}